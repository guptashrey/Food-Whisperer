# library imports
from multiprocessing import Pool
from inference import get_recommended_recipes
import pandas as pd
import os
import glob

# reading the raw interactions data
print("Reading Data...")
interactions = pd.read_csv("../data/raw/RAW_interactions.csv")

# sorting the interactions by user_id and rating
interactions.sort_values(by=["user_id", "rating"], ascending=False, inplace=True)
interactions = interactions[["user_id", "recipe_id", "rating"]]

# getting the top 5 interactions for each user based on highest rating
top_5_interactions = interactions.groupby("user_id").head().reset_index(drop=True)

# getting the unique recipe ids from the top 5 interactions
list_of_recipes = list(set(top_5_interactions.recipe_id))

def get_rec(first_last):
	"""
	Function for the pool handler to get recommendations for unique recipes

	Args:
		first_last (tuple): tuple containing the first and last index of the list of recipes to get recommendations for and the name of the file to save the recommendations

	Returns:
		None
	"""
	
	print(f"Generating recommendations for unique recipes from {first_last[0]} to {first_last[1]}")
	list_of_recipes_temp = list_of_recipes[first_last[0]:first_last[1]]
	pd.DataFrame(get_recommended_recipes(list_of_recipes_temp)).to_csv(f'../data/processed/coverage_calculation/{first_last[2]}.csv')

def pool_handler():
	"""
	Function to handle the multiprocessing pool

	Args:
		None

	Returns:
		None
	"""
	p=Pool(39)
	p.map(get_rec, [
		(0,100,'A000001'),
		(100,200,'A000002'),
		(200,300,'A000003'),
		(300,400,'A000004'),
		(400,500,'A000005'),
		(500,600,'A000006'),
		(600,700,'A000007'),
		(700,800,'A000008'),
		(800,900,'A000009'),
		(900,1000,'A000010'),
		(1000,1100,'A000011'),
		(1100,1200,'A000012'),
		(1200,1300,'A000013'),
		(1300,1400,'A000014'),
		(1400,1500,'A000015'),
		(1500,1600,'A000016'),
		(1600,1700,'A000017'),
		(1700,1800,'A000018'),
		(1800,1900,'A000019'),
		(1900,2000,'A000020'),
		(2000,2100,'A000021'),
		(2100,2200,'A000022'),
		(2200,2300,'A000023'),
		(2300,2400,'A000024'),
		(2400,2500,'A000025'),
		(2500,2600,'A000026'),
		(2600,2700,'A000027'),
		(2700,2800,'A000028'),
		(2800,2900,'A000029'),
		(2900,3000,'A000030'),
		(3000,3100,'A000031'),
		(3100,3200,'A000032'),
		(3200,3300,'A000033'),
		(3300,3400,'A000034'),
		(3400,3500,'A000035'),
		(3500,3600,'A000036'),
		(3600,3700,'A000037'),
		(3700,3800,'A000038'),
		(3800,3900,'A000039'),
		(3900,4000,'A000040'),
		(4000,4100,'A000041'),
		(4100,4200,'A000042'),
		(4200,4300,'A000043'),
		(4300,4400,'A000044'),
		(4400,4500,'A000045'),
		(4500,4600,'A000046'),
		(4600,4700,'A000047'),
		(4700,4800,'A000048'),
		(4800,4900,'A000049'),
		(4900,5000,'A000050'),
		(5000,5100,'A000051'),
		(5100,5200,'A000052'),
		(5200,5300,'A000053'),
		(5300,5400,'A000054'),
		(5400,5500,'A000055'),
		(5500,5600,'A000056'),
		(5600,5700,'A000057'),
		(5700,5800,'A000058'),
		(5800,5900,'A000059'),
		(5900,6000,'A000060'),
		(6000,6100,'A000061'),
		(6100,6200,'A000062'),
		(6200,6300,'A000063'),
		(6300,6400,'A000064'),
		(6400,6500,'A000065'),
		(6500,6600,'A000066'),
		(6600,6700,'A000067'),
		(6700,6800,'A000068'),
		(6800,6900,'A000069'),
		(6900,7000,'A000070'),
		(7000,7100,'A000071'),
		(7100,7200,'A000072'),
		(7200,7300,'A000073'),
		(7300,7400,'A000074'),
		(7400,7500,'A000075'),
		(7500,7600,'A000076'),
		(7600,7700,'A000077'),
		(7700,7800,'A000078'),
		(7800,7900,'A000079'),
		(7900,8000,'A000080'),
		(8000,8100,'A000081'),
		(8100,8200,'A000082'),
		(8200,8300,'A000083'),
		(8300,8400,'A000084'),
		(8400,8500,'A000085'),
		(8500,8600,'A000086'),
		(8600,8700,'A000087'),
		(8700,8800,'A000088'),
		(8800,8900,'A000089'),
		(8900,9000,'A000090'),
		(9000,9100,'A000091'),
		(9100,9200,'A000092'),
		(9200,9300,'A000093'),
		(9300,9400,'A000094'),
		(9400,9500,'A000095'),
		(9500,9600,'A000096'),
		(9600,9700,'A000097'),
		(9700,9800,'A000098'),
		(9800,9900,'A000099'),
		(9900,10000,'A000100'),
		(10000,10100,'A000101'),
		(10100,10200,'A000102'),
		(10200,10300,'A000103'),
		(10300,10400,'A000104'),
		(10400,10500,'A000105'),
		(10500,10600,'A000106'),
		(10600,10700,'A000107'),
		(10700,10800,'A000108'),
		(10800,10900,'A000109'),
		(10900,11000,'A000110'),
		(11000,11100,'A000111'),
		(11100,11200,'A000112'),
		(11200,11300,'A000113'),
		(11300,11400,'A000114'),
		(11400,11500,'A000115'),
		(11500,11600,'A000116'),
		(11600,11700,'A000117'),
		(11700,11800,'A000118'),
		(11800,11900,'A000119'),
		(11900,12000,'A000120'),
		(12000,12100,'A000121'),
		(12100,12200,'A000122'),
		(12200,12300,'A000123'),
		(12300,12400,'A000124'),
		(12400,12500,'A000125'),
		(12500,12600,'A000126'),
		(12600,12700,'A000127'),
		(12700,12800,'A000128'),
		(12800,12900,'A000129'),
		(12900,13000,'A000130'),
		(13000,13100,'A000131'),
		(13100,13200,'A000132'),
		(13200,13300,'A000133'),
		(13300,13400,'A000134'),
		(13400,13500,'A000135'),
		(13500,13600,'A000136'),
		(13600,13700,'A000137'),
		(13700,13800,'A000138'),
		(13800,13900,'A000139'),
		(13900,14000,'A000140'),
		(14000,14100,'A000141'),
		(14100,14200,'A000142'),
		(14200,14300,'A000143'),
		(14300,14400,'A000144'),
		(14400,14500,'A000145'),
		(14500,14600,'A000146'),
		(14600,14700,'A000147'),
		(14700,14800,'A000148'),
		(14800,14900,'A000149'),
		(14900,15000,'A000150'),
		(15000,15100,'A000151'),
		(15100,15200,'A000152'),
		(15200,15300,'A000153'),
		(15300,15400,'A000154'),
		(15400,15500,'A000155'),
		(15500,15600,'A000156'),
		(15600,15700,'A000157'),
		(15700,15800,'A000158'),
		(15800,15900,'A000159'),
		(15900,16000,'A000160'),
		(16000,16100,'A000161'),
		(16100,16200,'A000162'),
		(16200,16300,'A000163'),
		(16300,16400,'A000164'),
		(16400,16500,'A000165'),
		(16500,16600,'A000166'),
		(16600,16700,'A000167'),
		(16700,16800,'A000168'),
		(16800,16900,'A000169'),
		(16900,17000,'A000170'),
		(17000,17100,'A000171'),
		(17100,17200,'A000172'),
		(17200,17300,'A000173'),
		(17300,17400,'A000174'),
		(17400,17500,'A000175'),
		(17500,17600,'A000176'),
		(17600,17700,'A000177'),
		(17700,17800,'A000178'),
		(17800,17900,'A000179'),
		(17900,18000,'A000180'),
		(18000,18100,'A000181'),
		(18100,18200,'A000182'),
		(18200,18300,'A000183'),
		(18300,18400,'A000184'),
		(18400,18500,'A000185'),
		(18500,18600,'A000186'),
		(18600,18700,'A000187'),
		(18700,18800,'A000188'),
		(18800,18900,'A000189'),
		(18900,19000,'A000190'),
		(19000,19100,'A000191'),
		(19100,19200,'A000192'),
		(19200,19300,'A000193'),
		(19300,19400,'A000194'),
		(19400,19500,'A000195'),
		(19500,19600,'A000196'),
		(19600,19700,'A000197'),
		(19700,19800,'A000198'),
		(19800,19900,'A000199'),
		(19900,20000,'A000200'),
		(20000,20100,'A000201'),
		(20100,20200,'A000202'),
		(20200,20300,'A000203'),
		(20300,20400,'A000204'),
		(20400,20500,'A000205'),
		(20500,20600,'A000206'),
		(20600,20700,'A000207'),
		(20700,20800,'A000208'),
		(20800,20900,'A000209'),
		(20900,21000,'A000210'),
		(21000,21100,'A000211'),
		(21100,21200,'A000212'),
		(21200,21300,'A000213'),
		(21300,21400,'A000214'),
		(21400,21500,'A000215'),
		(21500,21600,'A000216'),
		(21600,21700,'A000217'),
		(21700,21800,'A000218'),
		(21800,21900,'A000219'),
		(21900,22000,'A000220'),
		(22000,22100,'A000221'),
		(22100,22200,'A000222'),
		(22200,22300,'A000223'),
		(22300,22400,'A000224'),
		(22400,22500,'A000225'),
		(22500,22600,'A000226'),
		(22600,22700,'A000227'),
		(22700,22800,'A000228'),
		(22800,22900,'A000229'),
		(22900,23000,'A000230'),
		(23000,23100,'A000231'),
		(23100,23200,'A000232'),
		(23200,23300,'A000233'),
		(23300,23400,'A000234'),
		(23400,23500,'A000235'),
		(23500,23600,'A000236'),
		(23600,23700,'A000237'),
		(23700,23800,'A000238'),
		(23800,23900,'A000239'),
		(23900,24000,'A000240'),
		(24000,24100,'A000241'),
		(24100,24200,'A000242'),
		(24200,24300,'A000243'),
		(24300,24400,'A000244'),
		(24400,24500,'A000245'),
		(24500,24600,'A000246'),
		(24600,24700,'A000247'),
		(24700,24800,'A000248'),
		(24800,24900,'A000249'),
		(24900,25000,'A000250'),
		(25000,25100,'A000251'),
		(25100,25200,'A000252'),
		(25200,25300,'A000253'),
		(25300,25400,'A000254'),
		(25400,25500,'A000255'),
		(25500,25600,'A000256'),
		(25600,25700,'A000257'),
		(25700,25800,'A000258'),
		(25800,25900,'A000259'),
		(25900,26000,'A000260'),
		(26000,26100,'A000261'),
		(26100,26200,'A000262'),
		(26200,26300,'A000263'),
		(26300,26400,'A000264'),
		(26400,26500,'A000265'),
		(26500,26600,'A000266'),
		(26600,26700,'A000267'),
		(26700,26800,'A000268'),
		(26800,26900,'A000269'),
		(26900,27000,'A000270'),
		(27000,27100,'A000271'),
		(27100,27200,'A000272'),
		(27200,27300,'A000273'),
		(27300,27400,'A000274'),
		(27400,27500,'A000275'),
		(27500,27600,'A000276'),
		(27600,27700,'A000277'),
		(27700,27800,'A000278'),
		(27800,27900,'A000279'),
		(27900,28000,'A000280'),
		(28000,28100,'A000281'),
		(28100,28200,'A000282'),
		(28200,28300,'A000283'),
		(28300,28400,'A000284'),
		(28400,28500,'A000285'),
		(28500,28600,'A000286'),
		(28600,28700,'A000287'),
		(28700,28800,'A000288'),
		(28800,28900,'A000289'),
		(28900,29000,'A000290'),
		(29000,29100,'A000291'),
		(29100,29200,'A000292'),
		(29200,29300,'A000293'),
		(29300,29400,'A000294'),
		(29400,29500,'A000295'),
		(29500,29600,'A000296'),
		(29600,29700,'A000297'),
		(29700,29800,'A000298'),
		(29800,29900,'A000299'),
		(29900,30000,'A000300'),
		(30000,30100,'A000301'),
		(30100,30200,'A000302'),
		(30200,30300,'A000303'),
		(30300,30400,'A000304'),
		(30400,30500,'A000305'),
		(30500,30600,'A000306'),
		(30600,30700,'A000307'),
		(30700,30800,'A000308'),
		(30800,30900,'A000309'),
		(30900,31000,'A000310'),
		(31000,31100,'A000311'),
		(31100,31200,'A000312'),
		(31200,31300,'A000313'),
		(31300,31400,'A000314'),
		(31400,31500,'A000315'),
		(31500,31600,'A000316'),
		(31600,31700,'A000317'),
		(31700,31800,'A000318'),
		(31800,31900,'A000319'),
		(31900,32000,'A000320'),
		(32000,32100,'A000321'),
		(32100,32200,'A000322'),
		(32200,32300,'A000323'),
		(32300,32400,'A000324'),
		(32400,32500,'A000325'),
		(32500,32600,'A000326'),
		(32600,32700,'A000327'),
		(32700,32800,'A000328'),
		(32800,32900,'A000329'),
		(32900,33000,'A000330'),
		(33000,33100,'A000331'),
		(33100,33200,'A000332'),
		(33200,33300,'A000333'),
		(33300,33400,'A000334'),
		(33400,33500,'A000335'),
		(33500,33600,'A000336'),
		(33600,33700,'A000337'),
		(33700,33800,'A000338'),
		(33800,33900,'A000339'),
		(33900,34000,'A000340'),
		(34000,34100,'A000341'),
		(34100,34200,'A000342'),
		(34200,34300,'A000343'),
		(34300,34400,'A000344'),
		(34400,34500,'A000345'),
		(34500,34600,'A000346'),
		(34600,34700,'A000347'),
		(34700,34800,'A000348'),
		(34800,34900,'A000349'),
		(34900,35000,'A000350'),
		(35000,35100,'A000351'),
		(35100,35200,'A000352'),
		(35200,35300,'A000353'),
		(35300,35400,'A000354'),
		(35400,35500,'A000355'),
		(35500,35600,'A000356'),
		(35600,35700,'A000357'),
		(35700,35800,'A000358'),
		(35800,35900,'A000359'),
		(35900,36000,'A000360'),
		(36000,36100,'A000361'),
		(36100,36200,'A000362'),
		(36200,36300,'A000363'),
		(36300,36400,'A000364'),
		(36400,36500,'A000365'),
		(36500,36600,'A000366'),
		(36600,36700,'A000367'),
		(36700,36800,'A000368'),
		(36800,36900,'A000369'),
		(36900,37000,'A000370'),
		(37000,37100,'A000371'),
		(37100,37200,'A000372'),
		(37200,37300,'A000373'),
		(37300,37400,'A000374'),
		(37400,37500,'A000375'),
		(37500,37600,'A000376'),
		(37600,37700,'A000377'),
		(37700,37800,'A000378'),
		(37800,37900,'A000379'),
		(37900,38000,'A000380'),
		(38000,38100,'A000381'),
		(38100,38200,'A000382'),
		(38200,38300,'A000383'),
		(38300,38400,'A000384'),
		(38400,38500,'A000385'),
		(38500,38600,'A000386'),
		(38600,38700,'A000387'),
		(38700,38800,'A000388'),
		(38800,38900,'A000389'),
		(38900,39000,'A000390'),
		(39000,39100,'A000391'),
		(39100,39200,'A000392'),
		(39200,39300,'A000393'),
		(39300,39400,'A000394'),
		(39400,39500,'A000395'),
		(39500,39600,'A000396'),
		(39600,39700,'A000397'),
		(39700,39800,'A000398'),
		(39800,39900,'A000399'),
		(39900,40000,'A000400'),
		(40000,40100,'A000401'),
		(40100,40200,'A000402'),
		(40200,40300,'A000403'),
		(40300,40400,'A000404'),
		(40400,40500,'A000405'),
		(40500,40600,'A000406'),
		(40600,40700,'A000407'),
		(40700,40800,'A000408'),
		(40800,40900,'A000409'),
		(40900,41000,'A000410'),
		(41000,41100,'A000411'),
		(41100,41200,'A000412'),
		(41200,41300,'A000413'),
		(41300,41400,'A000414'),
		(41400,41500,'A000415'),
		(41500,41600,'A000416'),
		(41600,41700,'A000417'),
		(41700,41800,'A000418'),
		(41800,41900,'A000419'),
		(41900,42000,'A000420'),
		(42000,42100,'A000421'),
		(42100,42200,'A000422'),
		(42200,42300,'A000423'),
		(42300,42400,'A000424'),
		(42400,42500,'A000425'),
		(42500,42600,'A000426'),
		(42600,42700,'A000427'),
		(42700,42800,'A000428'),
		(42800,42900,'A000429'),
		(42900,43000,'A000430'),
		(43000,43100,'A000431'),
		(43100,43200,'A000432'),
		(43200,43300,'A000433'),
		(43300,43400,'A000434'),
		(43400,43500,'A000435'),
		(43500,43600,'A000436'),
		(43600,43700,'A000437'),
		(43700,43800,'A000438'),
		(43800,43900,'A000439'),
		(43900,44000,'A000440'),
		(44000,44100,'A000441'),
		(44100,44200,'A000442'),
		(44200,44300,'A000443'),
		(44300,44400,'A000444'),
		(44400,44500,'A000445'),
		(44500,44600,'A000446'),
		(44600,44700,'A000447'),
		(44700,44800,'A000448'),
		(44800,44900,'A000449'),
		(44900,45000,'A000450'),
		(45000,45100,'A000451'),
		(45100,45200,'A000452'),
		(45200,45300,'A000453'),
		(45300,45400,'A000454'),
		(45400,45500,'A000455'),
		(45500,45600,'A000456'),
		(45600,45700,'A000457'),
		(45700,45800,'A000458'),
		(45800,45900,'A000459'),
		(45900,46000,'A000460'),
		(46000,46100,'A000461'),
		(46100,46200,'A000462'),
		(46200,46300,'A000463'),
		(46300,46400,'A000464'),
		(46400,46500,'A000465'),
		(46500,46600,'A000466'),
		(46600,46700,'A000467'),
		(46700,46800,'A000468'),
		(46800,46900,'A000469'),
		(46900,47000,'A000470'),
		(47000,47100,'A000471'),
		(47100,47200,'A000472'),
		(47200,47300,'A000473'),
		(47300,47400,'A000474'),
		(47400,47500,'A000475'),
		(47500,47600,'A000476'),
		(47600,47700,'A000477'),
		(47700,47800,'A000478'),
		(47800,47900,'A000479'),
		(47900,48000,'A000480'),
		(48000,48100,'A000481'),
		(48100,48200,'A000482'),
		(48200,48300,'A000483'),
		(48300,48400,'A000484'),
		(48400,48500,'A000485'),
		(48500,48600,'A000486'),
		(48600,48700,'A000487'),
		(48700,48800,'A000488'),
		(48800,48900,'A000489'),
		(48900,49000,'A000490'),
		(49000,49100,'A000491'),
		(49100,49200,'A000492'),
		(49200,49300,'A000493'),
		(49300,49400,'A000494'),
		(49400,49500,'A000495'),
		(49500,49600,'A000496'),
		(49600,49700,'A000497'),
		(49700,49800,'A000498'),
		(49800,49900,'A000499'),
		(49900,50000,'A000500'),
		(50000,50100,'A000501'),
		(50100,50200,'A000502'),
		(50200,50300,'A000503'),
		(50300,50400,'A000504'),
		(50400,50500,'A000505'),
		(50500,50600,'A000506'),
		(50600,50700,'A000507'),
		(50700,50800,'A000508'),
		(50800,50900,'A000509'),
		(50900,51000,'A000510'),
		(51000,51100,'A000511'),
		(51100,51200,'A000512'),
		(51200,51300,'A000513'),
		(51300,51400,'A000514'),
		(51400,51500,'A000515'),
		(51500,51600,'A000516'),
		(51600,51700,'A000517'),
		(51700,51800,'A000518'),
		(51800,51900,'A000519'),
		(51900,52000,'A000520'),
		(52000,52100,'A000521'),
		(52100,52200,'A000522'),
		(52200,52300,'A000523'),
		(52300,52400,'A000524'),
		(52400,52500,'A000525'),
		(52500,52600,'A000526'),
		(52600,52700,'A000527'),
		(52700,52800,'A000528'),
		(52800,52900,'A000529'),
		(52900,53000,'A000530'),
		(53000,53100,'A000531'),
		(53100,53200,'A000532'),
		(53200,53300,'A000533'),
		(53300,53400,'A000534'),
		(53400,53500,'A000535'),
		(53500,53600,'A000536'),
		(53600,53700,'A000537'),
		(53700,53800,'A000538'),
		(53800,53900,'A000539'),
		(53900,54000,'A000540'),
		(54000,54100,'A000541'),
		(54100,54200,'A000542'),
		(54200,54300,'A000543'),
		(54300,54400,'A000544'),
		(54400,54500,'A000545'),
		(54500,54600,'A000546'),
		(54600,54700,'A000547'),
		(54700,54800,'A000548'),
		(54800,54900,'A000549'),
		(54900,55000,'A000550'),
		(55000,55100,'A000551'),
		(55100,55200,'A000552'),
		(55200,55300,'A000553'),
		(55300,55400,'A000554'),
		(55400,55500,'A000555'),
		(55500,55600,'A000556'),
		(55600,55700,'A000557'),
		(55700,55800,'A000558'),
		(55800,55900,'A000559'),
		(55900,56000,'A000560'),
		(56000,56100,'A000561'),
		(56100,56200,'A000562'),
		(56200,56300,'A000563'),
		(56300,56400,'A000564'),
		(56400,56500,'A000565'),
		(56500,56600,'A000566'),
		(56600,56700,'A000567'),
		(56700,56800,'A000568'),
		(56800,56900,'A000569'),
		(56900,57000,'A000570'),
		(57000,57100,'A000571'),
		(57100,57200,'A000572'),
		(57200,57300,'A000573'),
		(57300,57400,'A000574'),
		(57400,57500,'A000575'),
		(57500,57600,'A000576'),
		(57600,57700,'A000577'),
		(57700,57800,'A000578'),
		(57800,57900,'A000579'),
		(57900,58000,'A000580'),
		(58000,58100,'A000581'),
		(58100,58200,'A000582'),
		(58200,58300,'A000583'),
		(58300,58400,'A000584'),
		(58400,58500,'A000585'),
		(58500,58600,'A000586'),
		(58600,58700,'A000587'),
		(58700,58800,'A000588'),
		(58800,58900,'A000589'),
		(58900,59000,'A000590'),
		(59000,59100,'A000591'),
		(59100,59200,'A000592'),
		(59200,59300,'A000593'),
		(59300,59400,'A000594'),
		(59400,59500,'A000595'),
		(59500,59600,'A000596'),
		(59600,59700,'A000597'),
		(59700,59800,'A000598'),
		(59800,59900,'A000599'),
		(59900,60000,'A000600'),
		(60000,60100,'A000601'),
		(60100,60200,'A000602'),
		(60200,60300,'A000603'),
		(60300,60400,'A000604'),
		(60400,60500,'A000605'),
		(60500,60600,'A000606'),
		(60600,60700,'A000607'),
		(60700,60800,'A000608'),
		(60800,60900,'A000609'),
		(60900,61000,'A000610'),
		(61000,61100,'A000611'),
		(61100,61200,'A000612'),
		(61200,61300,'A000613'),
		(61300,61400,'A000614'),
		(61400,61500,'A000615'),
		(61500,61600,'A000616'),
		(61600,61700,'A000617'),
		(61700,61800,'A000618'),
		(61800,61900,'A000619'),
		(61900,62000,'A000620'),
		(62000,62100,'A000621'),
		(62100,62200,'A000622'),
		(62200,62300,'A000623'),
		(62300,62400,'A000624'),
		(62400,62500,'A000625'),
		(62500,62600,'A000626'),
		(62600,62700,'A000627'),
		(62700,62800,'A000628'),
		(62800,62900,'A000629'),
		(62900,63000,'A000630'),
		(63000,63100,'A000631'),
		(63100,63200,'A000632'),
		(63200,63300,'A000633'),
		(63300,63400,'A000634'),
		(63400,63500,'A000635'),
		(63500,63600,'A000636'),
		(63600,63700,'A000637'),
		(63700,63800,'A000638'),
		(63800,63900,'A000639'),
		(63900,64000,'A000640'),
		(64000,64100,'A000641'),
		(64100,64200,'A000642'),
		(64200,64300,'A000643'),
		(64300,64400,'A000644'),
		(64400,64500,'A000645'),
		(64500,64600,'A000646'),
		(64600,64700,'A000647'),
		(64700,64800,'A000648'),
		(64800,64900,'A000649'),
		(64900,65000,'A000650'),
		(65000,65100,'A000651'),
		(65100,65200,'A000652'),
		(65200,65300,'A000653'),
		(65300,65400,'A000654'),
		(65400,65500,'A000655'),
		(65500,65600,'A000656'),
		(65600,65700,'A000657'),
		(65700,65800,'A000658'),
		(65800,65900,'A000659'),
		(65900,66000,'A000660'),
		(66000,66100,'A000661'),
		(66100,66200,'A000662'),
		(66200,66300,'A000663'),
		(66300,66400,'A000664'),
		(66400,66500,'A000665'),
		(66500,66600,'A000666'),
		(66600,66700,'A000667'),
		(66700,66800,'A000668'),
		(66800,66900,'A000669'),
		(66900,67000,'A000670'),
		(67000,67100,'A000671'),
		(67100,67200,'A000672'),
		(67200,67300,'A000673'),
		(67300,67400,'A000674'),
		(67400,67500,'A000675'),
		(67500,67600,'A000676'),
		(67600,67700,'A000677'),
		(67700,67800,'A000678'),
		(67800,67900,'A000679'),
		(67900,68000,'A000680'),
		(68000,68100,'A000681'),
		(68100,68200,'A000682'),
		(68200,68300,'A000683'),
		(68300,68400,'A000684'),
		(68400,68500,'A000685'),
		(68500,68600,'A000686'),
		(68600,68700,'A000687'),
		(68700,68800,'A000688'),
		(68800,68900,'A000689'),
		(68900,69000,'A000690'),
		(69000,69100,'A000691'),
		(69100,69200,'A000692'),
		(69200,69300,'A000693'),
		(69300,69400,'A000694'),
		(69400,69500,'A000695'),
		(69500,69600,'A000696'),
		(69600,69700,'A000697'),
		(69700,69800,'A000698'),
		(69800,69900,'A000699'),
		(69900,70000,'A000700'),
		(70000,70100,'A000701'),
		(70100,70200,'A000702'),
		(70200,70300,'A000703'),
		(70300,70400,'A000704'),
		(70400,70500,'A000705'),
		(70500,70600,'A000706'),
		(70600,70700,'A000707'),
		(70700,70800,'A000708'),
		(70800,70900,'A000709'),
		(70900,71000,'A000710'),
		(71000,71100,'A000711'),
		(71100,71200,'A000712'),
		(71200,71300,'A000713'),
		(71300,71400,'A000714'),
		(71400,71500,'A000715'),
		(71500,71600,'A000716'),
		(71600,71700,'A000717'),
		(71700,71800,'A000718'),
		(71800,71900,'A000719'),
		(71900,72000,'A000720'),
		(72000,72100,'A000721'),
		(72100,72200,'A000722'),
		(72200,72300,'A000723'),
		(72300,72400,'A000724'),
		(72400,72500,'A000725'),
		(72500,72600,'A000726'),
		(72600,72700,'A000727'),
		(72700,72800,'A000728'),
		(72800,72900,'A000729'),
		(72900,73000,'A000730'),
		(73000,73100,'A000731'),
		(73100,73200,'A000732'),
		(73200,73300,'A000733'),
		(73300,73400,'A000734'),
		(73400,73500,'A000735'),
		(73500,73600,'A000736'),
		(73600,73700,'A000737'),
		(73700,73800,'A000738'),
		(73800,73900,'A000739'),
		(73900,74000,'A000740'),
		(74000,74100,'A000741'),
		(74100,74200,'A000742'),
		(74200,74300,'A000743'),
		(74300,74400,'A000744'),
		(74400,74500,'A000745'),
		(74500,74600,'A000746'),
		(74600,74700,'A000747'),
		(74700,74800,'A000748'),
		(74800,74900,'A000749'),
		(74900,75000,'A000750'),
		(75000,75100,'A000751'),
		(75100,75200,'A000752'),
		(75200,75300,'A000753'),
		(75300,75400,'A000754'),
		(75400,75500,'A000755'),
		(75500,75600,'A000756'),
		(75600,75700,'A000757'),
		(75700,75800,'A000758'),
		(75800,75900,'A000759'),
		(75900,76000,'A000760'),
		(76000,76100,'A000761'),
		(76100,76200,'A000762'),
		(76200,76300,'A000763'),
		(76300,76400,'A000764'),
		(76400,76500,'A000765'),
		(76500,76600,'A000766'),
		(76600,76700,'A000767'),
		(76700,76800,'A000768'),
		(76800,76900,'A000769'),
		(76900,77000,'A000770'),
		(77000,77100,'A000771'),
		(77100,77200,'A000772'),
		(77200,77300,'A000773'),
		(77300,77400,'A000774'),
		(77400,77500,'A000775'),
		(77500,77600,'A000776'),
		(77600,77700,'A000777'),
		(77700,77800,'A000778'),
		(77800,77900,'A000779'),
		(77900,78000,'A000780'),
		(78000,78100,'A000781'),
		(78100,78200,'A000782'),
		(78200,78300,'A000783'),
		(78300,78400,'A000784'),
		(78400,78500,'A000785'),
		(78500,78600,'A000786'),
		(78600,78700,'A000787'),
		(78700,78800,'A000788'),
		(78800,78900,'A000789'),
		(78900,79000,'A000790'),
		(79000,79100,'A000791'),
		(79100,79200,'A000792'),
		(79200,79300,'A000793'),
		(79300,79400,'A000794'),
		(79400,79500,'A000795'),
		(79500,79600,'A000796'),
		(79600,79700,'A000797'),
		(79700,79800,'A000798'),
		(79800,79900,'A000799'),
		(79900,80000,'A000800'),
		(80000,80100,'A000801'),
		(80100,80200,'A000802'),
		(80200,80300,'A000803'),
		(80300,80400,'A000804'),
		(80400,80500,'A000805'),
		(80500,80600,'A000806'),
		(80600,80700,'A000807'),
		(80700,80800,'A000808'),
		(80800,80900,'A000809'),
		(80900,81000,'A000810'),
		(81000,81100,'A000811'),
		(81100,81200,'A000812'),
		(81200,81300,'A000813'),
		(81300,81400,'A000814'),
		(81400,81500,'A000815'),
		(81500,81600,'A000816'),
		(81600,81700,'A000817'),
		(81700,81800,'A000818'),
		(81800,81900,'A000819'),
		(81900,82000,'A000820'),
		(82000,82100,'A000821'),
		(82100,82200,'A000822'),
		(82200,82300,'A000823'),
		(82300,82400,'A000824'),
		(82400,82500,'A000825'),
		(82500,82600,'A000826'),
		(82600,82700,'A000827'),
		(82700,82800,'A000828'),
		(82800,82900,'A000829'),
		(82900,83000,'A000830'),
		(83000,83100,'A000831'),
		(83100,83200,'A000832'),
		(83200,83300,'A000833'),
		(83300,83400,'A000834'),
		(83400,83500,'A000835'),
		(83500,83600,'A000836'),
		(83600,83700,'A000837'),
		(83700,83800,'A000838'),
		(83800,83900,'A000839'),
		(83900,84000,'A000840'),
		(84000,84100,'A000841'),
		(84100,84200,'A000842'),
		(84200,84300,'A000843'),
		(84300,84400,'A000844'),
		(84400,84500,'A000845'),
		(84500,84600,'A000846'),
		(84600,84700,'A000847'),
		(84700,84800,'A000848'),
		(84800,84900,'A000849'),
		(84900,85000,'A000850'),
		(85000,85100,'A000851'),
		(85100,85200,'A000852'),
		(85200,85300,'A000853'),
		(85300,85400,'A000854'),
		(85400,85500,'A000855'),
		(85500,85600,'A000856'),
		(85600,85700,'A000857'),
		(85700,85800,'A000858'),
		(85800,85900,'A000859'),
		(85900,86000,'A000860'),
		(86000,86100,'A000861'),
		(86100,86200,'A000862'),
		(86200,86300,'A000863'),
		(86300,86400,'A000864'),
		(86400,86500,'A000865'),
		(86500,86600,'A000866'),
		(86600,86700,'A000867'),
		(86700,86800,'A000868'),
		(86800,86900,'A000869'),
		(86900,87000,'A000870'),
		(87000,87100,'A000871'),
		(87100,87200,'A000872'),
		(87200,87300,'A000873'),
		(87300,87400,'A000874'),
		(87400,87500,'A000875'),
		(87500,87600,'A000876'),
		(87600,87700,'A000877'),
		(87700,87800,'A000878'),
		(87800,87900,'A000879'),
		(87900,88000,'A000880'),
		(88000,88100,'A000881'),
		(88100,88200,'A000882'),
		(88200,88300,'A000883'),
		(88300,88400,'A000884'),
		(88400,88500,'A000885'),
		(88500,88600,'A000886'),
		(88600,88700,'A000887'),
		(88700,88800,'A000888'),
		(88800,88900,'A000889'),
		(88900,89000,'A000890'),
		(89000,89100,'A000891'),
		(89100,89200,'A000892'),
		(89200,89300,'A000893'),
		(89300,89400,'A000894'),
		(89400,89500,'A000895'),
		(89500,89600,'A000896'),
		(89600,89700,'A000897'),
		(89700,89800,'A000898'),
		(89800,89900,'A000899'),
		(89900,90000,'A000900'),
		(90000,90100,'A000901'),
		(90100,90200,'A000902'),
		(90200,90300,'A000903'),
		(90300,90400,'A000904'),
		(90400,90500,'A000905'),
		(90500,90600,'A000906'),
		(90600,90700,'A000907'),
		(90700,90800,'A000908'),
		(90800,90900,'A000909'),
		(90900,91000,'A000910'),
		(91000,91100,'A000911'),
		(91100,91200,'A000912'),
		(91200,91300,'A000913'),
		(91300,91400,'A000914'),
		(91400,91500,'A000915'),
		(91500,91600,'A000916'),
		(91600,91700,'A000917'),
		(91700,91800,'A000918'),
		(91800,91900,'A000919'),
		(91900,92000,'A000920'),
		(92000,92100,'A000921'),
		(92100,92200,'A000922'),
		(92200,92300,'A000923'),
		(92300,92400,'A000924'),
		(92400,92500,'A000925'),
		(92500,92600,'A000926'),
		(92600,92700,'A000927'),
		(92700,92800,'A000928'),
		(92800,92900,'A000929'),
		(92900,93000,'A000930'),
		(93000,93100,'A000931'),
		(93100,93200,'A000932'),
		(93200,93300,'A000933'),
		(93300,93400,'A000934'),
		(93400,93500,'A000935'),
		(93500,93600,'A000936'),
		(93600,93700,'A000937'),
		(93700,93800,'A000938'),
		(93800,93900,'A000939'),
		(93900,94000,'A000940'),
		(94000,94100,'A000941'),
		(94100,94200,'A000942'),
		(94200,94300,'A000943'),
		(94300,94400,'A000944'),
		(94400,94500,'A000945'),
		(94500,94600,'A000946'),
		(94600,94700,'A000947'),
		(94700,94800,'A000948'),
		(94800,94900,'A000949'),
		(94900,95000,'A000950'),
		(95000,95100,'A000951'),
		(95100,95200,'A000952'),
		(95200,95300,'A000953'),
		(95300,95400,'A000954'),
		(95400,95500,'A000955'),
		(95500,95600,'A000956'),
		(95600,95700,'A000957'),
		(95700,95800,'A000958'),
		(95800,95900,'A000959'),
		(95900,96000,'A000960'),
		(96000,96100,'A000961'),
		(96100,96200,'A000962'),
		(96200,96300,'A000963'),
		(96300,96400,'A000964'),
		(96400,96500,'A000965'),
		(96500,96600,'A000966'),
		(96600,96700,'A000967'),
		(96700,96800,'A000968'),
		(96800,96900,'A000969'),
		(96900,97000,'A000970'),
		(97000,97100,'A000971'),
		(97100,97200,'A000972'),
		(97200,97300,'A000973'),
		(97300,97400,'A000974'),
		(97400,97500,'A000975'),
		(97500,97600,'A000976'),
		(97600,97700,'A000977'),
		(97700,97800,'A000978'),
		(97800,97900,'A000979'),
		(97900,98000,'A000980'),
		(98000,98100,'A000981'),
		(98100,98200,'A000982'),
		(98200,98300,'A000983'),
		(98300,98400,'A000984'),
		(98400,98500,'A000985'),
		(98500,98600,'A000986'),
		(98600,98700,'A000987'),
		(98700,98800,'A000988'),
		(98800,98900,'A000989'),
		(98900,99000,'A000990'),
		(99000,99100,'A000991'),
		(99100,99200,'A000992'),
		(99200,99300,'A000993'),
		(99300,99400,'A000994'),
		(99400,99500,'A000995'),
		(99500,99600,'A000996'),
		(99600,99700,'A000997'),
		(99700,99800,'A000998'),
		(99800,99900,'A000999'),
		(99900,100000,'A001000'),
		(100000,100100,'A001001'),
		(100100,100200,'A001002'),
		(100200,100300,'A001003'),
		(100300,100400,'A001004'),
		(100400,100500,'A001005'),
		(100500,100600,'A001006'),
		(100600,100700,'A001007'),
		(100700,100800,'A001008'),
		(100800,100900,'A001009'),
		(100900,101000,'A001010'),
		(101000,101100,'A001011'),
		(101100,101200,'A001012'),
		(101200,101300,'A001013'),
		(101300,101400,'A001014'),
		(101400,101500,'A001015'),
		(101500,101600,'A001016'),
		(101600,101700,'A001017'),
		(101700,101800,'A001018'),
		(101800,101900,'A001019'),
		(101900,102000,'A001020'),
		(102000,102100,'A001021'),
		(102100,102200,'A001022'),
		(102200,102300,'A001023'),
		(102300,102400,'A001024'),
		(102400,102500,'A001025'),
		(102500,102600,'A001026'),
		(102600,102700,'A001027'),
		(102700,102800,'A001028'),
		(102800,102900,'A001029'),
		(102900,103000,'A001030'),
		(103000,103100,'A001031'),
		(103100,103200,'A001032'),
		(103200,103300,'A001033'),
		(103300,103400,'A001034'),
		(103400,103500,'A001035'),
		(103500,103600,'A001036'),
		(103600,103700,'A001037'),
		(103700,103800,'A001038'),
		(103800,103900,'A001039'),
		(103900,104000,'A001040'),
		(104000,104100,'A001041'),
		(104100,104200,'A001042'),
		(104200,104300,'A001043'),
		(104300,104400,'A001044'),
		(104400,104500,'A001045'),
		(104500,104600,'A001046'),
		(104600,104700,'A001047'),
		(104700,104800,'A001048'),
		(104800,104900,'A001049'),
		(104900,105000,'A001050'),
		(105000,105100,'A001051'),
		(105100,105200,'A001052'),
		(105200,105300,'A001053'),
		(105300,105400,'A001054'),
		(105400,105500,'A001055'),
		(105500,105600,'A001056'),
		(105600,105700,'A001057'),
		(105700,105800,'A001058'),
		(105800,105900,'A001059'),
		(105900,106000,'A001060'),
		(106000,106100,'A001061'),
		(106100,106200,'A001062'),
		(106200,106300,'A001063'),
		(106300,106400,'A001064'),
		(106400,106500,'A001065'),
		(106500,106600,'A001066'),
		(106600,106700,'A001067'),
		(106700,106800,'A001068'),
		(106800,106900,'A001069'),
		(106900,107000,'A001070')
	])

if __name__ == '__main__':
	
	print("Generating top recommendations for all users in the dataset.")
	
	# Generate recommendations for all users in the dataset using the pool_handler() function.
	# Commented as it takes a long time to run and the results are already saved in the data/processed/coverage_calculation folder.
	
	#pool_handler()
	
	print("Recommendation generation completed.")
	
	# Read all the csv files in the data/processed/coverage_calculation folder and concatenate them into a single dataframe.
	path = '../data/processed/coverage_calculation/'
	extension = 'csv'
	os.chdir(path)
	result = glob.glob('*.{}'.format(extension))

	for i in range(len(result)):
		if i == 0:
			final = pd.read_csv(result[i])

		else:
			temp = pd.read_csv(result[i])
			final = pd.concat([final, temp], axis=0)

	# Calculate the coverage of the recommendation system by dividing the number of unique items recommended by the total number of items in the dataset.
	print(f"The coverage of the recommendation system is: {round(((len(set(final.id))/230186)*100), 2)}%.")